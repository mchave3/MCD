<!-- Generated by build task Generate_Repo_Docs. Do not edit manually. -->
# New-MCDWinPEBootImage

Source: `source/Private/Workspace/BootImage/New-MCDWinPEBootImage.ps1`

## Synopsis

Creates a bootable Windows PE image from installed ADK components.

## Description

Orchestrates the WinPE boot image creation pipeline by copying ADK WinPE media
to a working directory, mounting the boot.wim, optionally adding WinPE packages,
dismounting, and building an ISO with oscdimg. Supports both amd64 and arm64
architectures. Uses installed ADK tooling to produce bootable media.

## Parameters

| Name | Type | Mandatory | Pipeline | Description |
| --- | --- | --- | --- | --- |
| WorkspacePath | String | Yes | No | Path to the workspace directory where the WinPE media will be built. A 'WinPE' subdirectory will be created for the working files. |
| Architecture | String | No | No | Target architecture for the WinPE image. Valid values are 'amd64' or 'arm64'. Defaults to 'amd64'. |
| IsoOutputPath | String | No | No | Full path where the output ISO file will be created. If not specified, defaults to 'WinPE_MCD_<Architecture>.iso' in the workspace directory. |
| IsoLabel | String | No | No | Volume label for the ISO file. Limited to 16 characters. Defaults to 'MCD_WINPE'. |
| Packages | String[] | No | No | Array of WinPE optional component names to add to the boot image. Package names should be specified without path (e.g., 'WinPE-WMI', 'WinPE-PowerShell'). |
| NoPrompt | SwitchParameter | No | No | When specified, creates an ISO that boots without the 'Press any key' prompt. |
| CleanupWorkingDirectory | SwitchParameter | No | No | When specified, removes the working directory after ISO creation. |

## Examples

### Example 1

```powershell
New-MCDWinPEBootImage -WorkspacePath 'C:\MCD\Workspace' -Architecture 'amd64'

Creates an amd64 WinPE boot image ISO in the workspace directory.
```

### Example 2

```powershell
New-MCDWinPEBootImage -WorkspacePath 'C:\MCD\Workspace' -Architecture 'arm64' -IsoOutputPath 'C:\Output\WinPE_arm64.iso' -NoPrompt

Creates an arm64 WinPE boot image ISO at the specified path without boot prompt.
```
