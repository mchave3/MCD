<!-- Generated by build task Generate_Repo_Docs. Do not edit manually. -->
# Update-MCDWindowsEsdCatalogCache

Source: `source/Private/OperatingSystem/Update-MCDWindowsEsdCatalogCache.ps1`

## Synopsis

Generates the in-repo Windows ESD catalog cache.

## Description

Builds a deterministic JSON (and XML) catalog of downloadable Windows ESD media
by downloading Microsoft fwlink CAB(s), extracting products.xml, parsing
MCT.Catalogs.Catalog.PublishedMedia.Files.File, filtering ESD entries, and writing
the output to the specified cache directory.

## Parameters

| Name | Type | Mandatory | Pipeline | Description |
| --- | --- | --- | --- | --- |
| OutputDirectory | String | Yes | No | Output directory where catalog files will be written. |
| Fwlinks | Hashtable[] | No | No | List of fwlink sources to download. Each entry must provide Id and Url. |
| ClientTypes | String[] | No | No | Client type filters that must appear in the FilePath (e.g. CLIENTCONSUMER, CLIENTBUSINESS). Use both to build a combined catalog. |
| ProductsXmlInputs | Hashtable[] | No | No | Optional offline inputs (for tests) to avoid downloading. Each entry must provide SourceFwlinkId and Path to a products.xml file. |
| UseWorProject | SwitchParameter | No | No | If set (default), uses WORProject MCT Catalogs API to enumerate historical CAB catalogs and selects the latest UBR per build major. |
| WorProjectVersionsUri | String | No | No | URI to WORProject getversions endpoint. |
| MinimumBuildMajorWin10 | Int32 | No | No | Minimum build major (e.g. 19041) to include for Windows 10 when using WORProject. |
| MinimumBuildMajorWin11 | Int32 | No | No | Minimum build major (e.g. 22000) to include for Windows 11 when using WORProject. |
| IncludeUrl | SwitchParameter | No | No | Includes direct download URLs in the committed catalog. |
| IncludeKey | SwitchParameter | No | No | Includes the Key field from products.xml in the committed catalog. |
| MinimumItemCount | Int32 | No | No | Minimum number of items expected in the resulting catalog. If the generated catalog contains fewer items, the function throws to detect fwlink/schema drift. |

## Examples

### Example 1

```powershell
Update-MCDWindowsEsdCatalogCache -OutputDirectory '.\source\Cache\Operating System'
```
