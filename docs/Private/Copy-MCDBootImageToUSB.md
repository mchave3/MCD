<!-- Generated by build task Generate_Repo_Docs. Do not edit manually. -->
# Copy-MCDBootImageToUSB

Source: `source/Private/Workspace/USB/Copy-MCDBootImageToUSB.ps1`

## Synopsis

Copies boot image files (ISO contents) to a formatted USB Boot partition.

## Description

Copies the contents of a WinPE boot ISO or mounted ISO to the Boot partition
of a formatted USB drive. This includes EFI boot files, boot manager, BCD,
and WinPE boot.wim.

The function expects the source to be either:
- A mounted ISO drive letter (e.g., 'E:\')
- A path to extracted boot media content

The destination should be the Boot partition created by Format-MCDUSB.

This is a potentially destructive operation as it overwrites existing files
on the target partition. Implements ShouldProcess for safety.

## Parameters

| Name | Type | Mandatory | Pipeline | Description |
| --- | --- | --- | --- | --- |
| MediaPath | String | Yes | No | Path to the WinPE media directory (mounted ISO root or extracted folder). Must contain the expected boot structure: 'boot', 'efi', and 'sources' directories. Alias: SourcePath |
| BootDriveLetter | String | Yes | No | Drive letter of the target Boot partition (without colon). Alias: DestinationDriveLetter |
| UseRobocopy | SwitchParameter | No | No | Use Robocopy instead of Copy-Item for more reliable copying. Default is true. |

## Examples

### Example 1

```powershell
Copy-MCDBootImageToUSB -MediaPath 'E:\' -BootDriveLetter 'B'

Copies boot files from mounted ISO at E:\ to USB Boot partition B:.
```

### Example 2

```powershell
$usbInfo = Format-MCDUSB -DiskNumber 2
Mount-DiskImage -ImagePath 'C:\WinPE.iso'
$isoLetter = (Get-DiskImage -ImagePath 'C:\WinPE.iso' | Get-Volume).DriveLetter
Copy-MCDBootImageToUSB -MediaPath "$isoLetter`:\" -BootDriveLetter $usbInfo.BootDriveLetter

Full workflow: format USB, mount ISO, copy boot files.
```
