<!-- Generated by build task Generate_Repo_Docs. Do not edit manually. -->
# Start-MCDWorkspaceOperationAsync

Source: `source/Private/Workspace/Core/Start-MCDWorkspaceOperationAsync.ps1`

## Synopsis

Starts a background operation in an STA runspace without blocking the UI thread.

## Description

Creates a dedicated STA runspace and executes the provided ScriptBlock asynchronously.
Returns a PSCustomObject containing the PowerShell instance, Runspace, and AsyncResult
so the caller can track progress or wait for completion. Logs start/stop events using
Write-MCDLog. This pattern keeps WPF UI responsive during long-running operations.

## Parameters

| Name | Type | Mandatory | Pipeline | Description |
| --- | --- | --- | --- | --- |
| ScriptBlock | ScriptBlock | Yes | No | The script block to execute in the background runspace. |
| ArgumentList | Object[] | No | No | Optional array of arguments to pass to the script block. |

## Examples

### Example 1

```powershell
$handle = Start-MCDWorkspaceOperationAsync -ScriptBlock { param($path) Get-ChildItem -Path $path } -ArgumentList 'C:\Windows'
# Later: $handle.PowerShell.EndInvoke($handle.AsyncResult)

Starts a background operation that lists files and returns a handle to track it.
```

### Example 2

```powershell
$handle = Start-MCDWorkspaceOperationAsync -ScriptBlock { Start-Sleep -Seconds 5; 'Done' }
while (-not $handle.AsyncResult.IsCompleted) { Start-Sleep -Milliseconds 100 }
$result = $handle.PowerShell.EndInvoke($handle.AsyncResult)

Starts a long-running operation and polls for completion.
```
